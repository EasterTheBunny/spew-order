#!/bin/bash

PROJECT=$(echo $PROJECT_ID)
ENVLOC=$(echo "$ENVIRONMENT-$LOCATION")

source ./vars

echo "config gcloud"
gcloud config set project $PROJECT
gcloud auth activate-service-account --key-file=./configurations/key.json

# deploy RestAPI
echo "deploying rest api for $ENVIRONMENT and $LOCATION"
gcloud functions deploy order-api-$ENVLOC \
	--project $PROJECT \
	--entry-point RestAPI \
	--env-vars-file ./configurations/config.yaml \
	--runtime go113 \
	--trigger-http \
	--allow-unauthenticated